Table of Contents
=================
   * [Εγκατάσταση](#εγκατάσταση)
      * [Απαιτήσεις](#απαιτήσεις)
      * [Οδηγίες Εγκατάστασης](#οδηγίες-εγκατάστασης)
   * [Περιγραφή API](#περιγραφή-api)
      * [Methods](#methods)
         * [Board](#board)
            * [Ανάγνωση Board](#ανάγνωση-board)
            * [Αρχικοποίηση Board](#αρχικοποίηση-board)
         * [Piece](#piece)
            * [Ανάγνωση Θέσης/Πιονιού](#ανάγνωση-θέσηςπιονιού)
            * [Μεταβολή Θέσης Πιονιού](#μεταβολή-θέσης-πιονιού)
         * [Player](#player)
            * [Ανάγνωση στοιχείων παίκτη](#ανάγνωση-στοιχείων-παίκτη)
            * [Καθορισμός στοιχείων παίκτη](#καθορισμός-στοιχείων-παίκτη)
         * [Status](#status)
            * [Ανάγνωση κατάστασης παιχνιδιού](#ανάγνωση-κατάστασης-παιχνιδιού)
      * [Entities](#entities)
         * [Board](#board-1)
         * [Players](#players)
         * [Game_status](#game_status)


# Demo Page

Μπορείτε να κατεβάσετε τοπικά ή να επισκεφτείτε την σελίδα: 
https://users.iee.ihu.gr/~it175103/ADISE19_ProjectDry/



# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php

## Οδηγίες Εγκατάστασης

 * Κάντε clone το project σε κάποιον φάκελο <br/>
  `$ git clone https://github.com/iee-ihu-gr-course1941/ADISE19_ProjectDry`

 * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. Πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

 * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'project_db' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο db/schema.sql

 * Θα πρέπει να φτιάξετε το αρχείο lib/config_local.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = 'κωδικός';
	$DB_USER = 'όνομα χρήστη';
    ?>
```

# Περιγραφή Παιχνιδιού

H ξερή είναι παιχνίδι τράπουλας 52 φύλλων που παίζεται με 2 ή 4 άτομα (ανά 2 σε ομάδες). Σε κάθε γύρο του παιχνιδιού μοιράζονται 4 φύλλα σε κάθε παίκτη, ενώ κατά τον πρώτο γύρο ρίχνοται και 4 φύλλα στο τραπέζι. Οι παίκτες παίζουν εναλλάξ χωρίς περιορισμό στην επιλογή του φύλλου.

Αν ένας παίκτης ρίξει βαλέ ή φύλλο με ίδιο αριθμό με αυτό που είχε ριχτεί τελευταίο στο τραπέζι, μαζεύει όλα τα φύλλα που έχουν παιχτεί μέχρι εκείνη τη στιγμή στο τραπέζι. Αν στο τραπέζι βρίσκεται μόνο ένα φύλλο, τότε κάνει ξερή.

Για κάθε ξερή ο παίκτης κερδίζει 10 πόντους, ενώ από τα υπόλοιπα φύλλα που μάζεψε κερδίζει 1 πόντο για κάθε Α, Κ, Q, J, 10 (εκτός του 10 καρό) και 2 σπαθί, και 2 πόντους για το 10 καρό.
Ο παίκτης με τα περισσότερα κερδισμένα φύλλα, κερδίζει επιπλέον 3 πόντους.

Η βάση μας κρατάει τους παρακάτω πίνακες: board, board_empty, players, game_status

Υλοποιήθηκαν οι παρακάτω απαιτήσεις:

- Αρχικοποίηση σύνδεσης-authentication.
- Έλεγχος κανόνων παιχνιδιού.
- Αναγνώριση σειράς παιξιάς.
- Αναγνώριση DeadLock (τέλος παιχνιδιού ή ο παίκτης εγκατέλειψε).
- Υπολογισμός σκορ / Ανάδειξη νικητή.
- Ανάπτυξη API.
- Ανάπτυξη GUI.
- Πλήρης αποθήκευση κατάστασης παιχνιδιού σε mysql.

## Συντελεστές

Καθ' όλη τη φάση ανάπτυξης της εφαρμογής, συμμετείχαν αλφαβητικά οι:
- Καριώτης Αλέξανδρος-Πολυχρόνης
- Παντούσης Εμμανουήλ
- Σίντου Κασσιανή
- Σκετοπούλου Θεοδώρα


# Περιγραφή API

## Methods


### Board
#### Ανάγνωση Board

```
GET /board/
```

Επιστρέφει το [Board](#Board) (ουσιαστικά τα φύλλα του παίκτη που έκανε το request και τα φύλλα που έχουν παιχτεί στο τραπέζι).

#### Αρχικοποίηση Board
```
POST /board/
```

Αρχικοποιεί το Board, δηλαδή το παιχνίδι. Γίνονται reset τα πάντα σε σχέση με το παιχνίδι.
Επιστρέφει το [Board](#Board).

### Card
#### Παίξιμο κάρτας

```
PUT /board/card/:x
```

Παίζει την κάρτα με αναγνωριστικό x από το χέρι του παίκτη στο τραπέζι, και αν είναι το κατάλληλο, μαζεύει τις υπόλοιπες κάρτες. Προφανώς ελέγχεται αν η κάρτα υπάρχει στο χέρι του παίκτη, καθώς και αν είναι η σειρά του παίκτη να παίξει με βάση το token.
Επιστρέφει τα νέα στοιχεία από το [Board](#Board-1).

Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `x`               | Το αναγνωριστικό της κάρτας x                | yes        |


### Player

#### Ανάγνωση στοιχείων παίκτη
```
GET /players/:p
```

Επιστρέφει τα στοιχεία του παίκτη p ή όλων των παικτών αν παραληφθεί. Το p μπορεί να είναι 1 ή 2.

#### Καθορισμός στοιχείων παίκτη
```
PUT /players/:p
```

Επιστρέφει τα στοιχεία του παίκτη p και ένα token. Το token πρέπει να το χρησιμοποιεί ο παίκτης καθόλη τη διάρκεια του παιχνιδιού.

Json Data:

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Το username για τον παίκτη p. | yes        |



### Status

#### Ανάγνωση κατάστασης παιχνιδιού
```
GET /status/
```

Επιστρέφει το στοιχείο [Game_status](#Game_status).



## Entities


### Board
---------

Το board είναι ένας πίνακας, ο οποίος στο κάθε στοιχείο έχει τα παρακάτω:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `card_id`                      | Το αναγνωριστικό της κάρτας              | 1...52                                |
| `c_value`                      | H αριθμητική αξία της κάρτας              | 1...13                                |
| `c_score`                | Η παικτική αξία της κάρτας                      | 0...2                             |
| `c_position`            | Η θέση της κάρτας στο board                         | 'deck', 'stack', 'top', 'hand1', 'hand2', 'won1', 'won2', 'dry1', 'dry2'                       |
| `c_order`                  | Η σειρά της κάρτας στην τράπουλα           | 1...52, null       |


### Players
---------

O κάθε παίκτης έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `p_id`               | Το αναγνωριστικό του παίκτη                                 | 1, 2                              |
| `username`            | To username που επιλέγει ο παίκτης                | String                             |
| `token  `                | To κρυφό token του παίκτη. Επιστρέφεται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |
| `last_action`            | Τελευταία αλλαγή/ενέργεια του παίκτη                | Timestamp                             |


### Game_status
---------

H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:


| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `s_id`               | Το αναγνωριστικό για τον πίνακα game_status             | Integer    |
| `status`               | Κατάσταση             | 'not active', 'initialized', 'started', 'ended', 'aborted'     |
| `p_turn`                 | Το αναγνωριστικό του παίκτη που παίζει       | 1, 2, null                              |
| `result`                 |  To αναγνωριστικό του παίκτη που κέρδισε |1, 2, null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | Timestamp |
